# Testbench модуля data_aligner
Данный тестбенч разработан для верификации модуля `data_aligner`. Техническое задание на `data_aligner` с описанием входных и выходных интерфейсов, а также конфигурационных параметров представлено в файле `ТЗ_data_aligner`.

## Описание testbench
Testbench выполняет следующие проверки модуля `data_aligner`:
1. Проверка уорректности синхронизации данных,
первичные и вторичные данные правильно выравниваются с учетом задержки;
2. Порядок данных - данные выдаются в том же порядке, в котором были записаны;
3. Флаги статусов - корректная установка флагов `full` и `empty`;
4. Обработка `valid` сигналов;

Проверка граничных и стрессовых условий:
1. Непрерывный поток данных при интенсивности 100%;
2. Обработка сброса;
3. Проверка одновременной записи и чтения данных;
4. Граничные состояния `FIFO` - поведение при полном и пустом `FIFO`;
5. Проверка поведения при переполнении FIFO;

Параметризация:
1. Настраиваемая задержка - проверка работы с разными значениями `DELAY_BW_1ST_2D`;
2. Различная глубина `FIFO` - адаптация к изменению `DEPTH_FIFO`;
Дополнительно:
1. Проверка корректной инициализации при подаче сигнала сброса.

## Генерация
Представленный testbench случайным образом генерирует различные значения
`data_1st_i`, `data_2d_i`, `write_intense`.

Регулировка интенсивности данных:
Интенсивность записи `write_intense`: регулируется в диапазоне 0-100%, где
0% - данные не приходят ни разу за время теста, 100% - данные приходят каждый такт. Значение по умолчанию: 70%
Генерация пакетов:
Количество пакетов `pkt_amount`: случайным образом генерируется в диапазоне 100-500 пакетов.
Задержка между первичными и вторичными данными: строго соответствует параметру `DELAY_BW_1ST_2D`. Значение по умолчанию: 4.
Флаг `flag_fifo_full` для проверки переполения очереди. Если `flag_fifo_full` = 1, то очередь переполняется и некоторые значения пропускаются, если = 0, то
программа работает без аварийных случаев переполнения.

Особенности генерации:
1. Вторичные данные всегда подаются с фиксированной задержкой относительно первичных;
2. Между пакетами создаются паузы в соответствии с установленной интенсивностью;
3. Возможность независимой подачи valid_1st_i и valid_2d_i

Конфигурационные параметры самого модуля `data_aligner` задаются в файле `data_align_testbench.sv` и пробрасываются в файл конфигурации `data_align_cfg.sv`. А в этом файле рандомизируются уже значения для конфигурации самого модуля testbench'а. Сделано это, для удобства работы с параметрами в разных файлах и для минимизации использования "магических" чисел.

Проверяемые условия:
1. Корректность данных - соответствие выходных данных ожидаемым значениям;
2. Корректность статусов - проверка флагов statuses_o;
3. Отсутствие потерь - контроль за тем, что все отправленные данные корректно обрабатываются;
4. Реакция на сброс - проверка инициализации регистров и состояний после сброса;
5. Отсутствие потерь при переполнении очереди.

## Выдача результатов теста
1. Выдается отладочная информация для отображения процесса проверки каждого пакета, так же ифнормирование о нештатных ситуациях, таких как пустой FIFO и переполненный, с предупреждением о потере данных;
2. Для каждой ошибки выводится: время возникновения, ожидаемые значения данных и статусов и фактические значения от DUT;
3. Тест останавливается при обнаружении критической ошибки;

Итоговые результаты:
1. При успешном завершении: отображается количество проверенных пакетов;
2. При обнаружении ошибок: выводится детальная информация о первой обнаруженной ошибке;

